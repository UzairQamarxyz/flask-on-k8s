security:
  enabled: true
  existingSecret: "elasticsearch-secret"
  tls:
    restEncryption: true
    autoGenerated: true

master:
  replicaCount: 1
  extraRoles:
    - data
    - ingest

  # Mount the kibana-secret for the master pod specifically.
  # extraVolumeMounts:
  #   - name: kibana-password-volume
  #     mountPath: /mnt/secrets/kibana-password
  #     subPath: kibana-password
  #     readOnly: true
  # extraVolumes:
  #   - name: kibana-password-volume
  #     secret:
  #       secretName: kibana-secret

  # This lifecycle hook runs after the ES server starts.
  # lifecycleHooks:
  #   postStart:
  #     exec:
  #       command:
  #         - /bin/sh
  #         - -c
  #         - |
  #           #!/bin/bash
  #           ELASTIC_PASS_FILE="/opt/bitnami/elasticsearch/secrets/elasticsearch-password"
  #           KIBANA_PASS_FILE="/mnt/secrets/kibana-password"

  #           # Wait for files and API
  #           while [ ! -f "${ELASTIC_PASS_FILE}" ] || [ ! -f "${KIBANA_PASS_FILE}" ]; do sleep 2; done
  #           until curl -k -s "https://localhost:9200"; do sleep 5; done

  #           echo "postStart: Elasticsearch is available. Setting kibana_system password."

  #           curl -k -X POST -u "elastic:$(cat ${ELASTIC_PASS_FILE})" "https://localhost:9200/_security/user/kibana_system/_password" -H 'Content-Type: application/json' -d"{\"password\" : \"$(cat ${KIBANA_PASS_FILE})\"}"

  persistence:
    enabled: true
    storageClass: "local-storage"
    size: 10Gi
  tolerations:
    - key: "node-role.kubernetes.io/control-plane"
      operator: "Exists"
      effect: "NoSchedule"

data:
  replicaCount: 0
ingest:
  enabled: false
coordinating:
  replicaCount: 0
